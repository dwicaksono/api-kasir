# kasir-api

A RESTful API for a cashier (Point of Sale) system built with Go, following Clean Architecture principles.

## üìÅ Project Structure

```
kasir-api/
‚îú‚îÄ‚îÄ cmd/
‚îÇ   ‚îî‚îÄ‚îÄ api/
‚îÇ       ‚îî‚îÄ‚îÄ main.go          # Application entry point
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ config.go        # Configuration management (Viper)
‚îÇ   ‚îú‚îÄ‚îÄ domain/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ product.go       # Product entity & interfaces
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ category.go      # Category entity & interfaces
‚îÇ   ‚îú‚îÄ‚îÄ handler/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ product_handler.go   # HTTP handlers for products
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ category_handler.go  # HTTP handlers for categories
‚îÇ   ‚îú‚îÄ‚îÄ repository/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ product_repository.go   # Database operations for products
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ category_repository.go  # Database operations for categories
‚îÇ   ‚îî‚îÄ‚îÄ usecase/
‚îÇ       ‚îú‚îÄ‚îÄ product_usecase.go   # Business logic for products
‚îÇ       ‚îî‚îÄ‚îÄ category_usecase.go  # Business logic for categories
‚îú‚îÄ‚îÄ pkg/
‚îÇ   ‚îî‚îÄ‚îÄ database/
‚îÇ       ‚îî‚îÄ‚îÄ postgres.go      # Database connection utilities
‚îú‚îÄ‚îÄ .env                     # Environment variables (DO NOT COMMIT)
‚îú‚îÄ‚îÄ go.mod
‚îî‚îÄ‚îÄ go.sum
```

## üèóÔ∏è Architecture Overview

This project follows **Clean Architecture** (also known as Hexagonal/Onion Architecture):

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     HTTP Handlers                       ‚îÇ
‚îÇ                   (internal/handler)                    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                      Use Cases                          ‚îÇ
‚îÇ                   (internal/usecase)                    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                      Domain Layer                       ‚îÇ
‚îÇ        Entities & Interfaces (internal/domain)          ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                     Repositories                        ‚îÇ
‚îÇ                  (internal/repository)                  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                       Database                          ‚îÇ
‚îÇ                     (pkg/database)                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Layer Responsibilities

| Layer | Location | Responsibility |
|-------|----------|----------------|
| **Domain** | `internal/domain/` | Entities (structs) and interface definitions. No dependencies on other layers. |
| **Use Case** | `internal/usecase/` | Business logic. Orchestrates data flow between handlers and repositories. |
| **Repository** | `internal/repository/` | Data persistence. Implements domain interfaces using PostgreSQL. |
| **Handler** | `internal/handler/` | HTTP request/response handling. Parses input, calls use cases, returns JSON. |
| **Config** | `internal/config/` | Configuration loading via Viper (environment variables). |
| **Database** | `pkg/database/` | Shared database connection pool. |

### Dependency Flow

```
Handler ‚Üí Usecase ‚Üí Repository
           ‚Üì
        Domain (interfaces)
```

> **Key Principle**: Dependencies point inward. The domain layer has no external dependencies.

## üöÄ Getting Started

### Prerequisites

- Go 1.22+ (uses `PathValue` for routing)
- PostgreSQL database

### Setup

1. **Clone the repository**
   ```bash
   git clone <your-repo-url>
   cd kasir-api
   ```

2. **Configure environment variables**
   
   Create a `.env` file in the project root:
   ```env
   PORT=8080
   DB_CONN=postgresql://user:password@host:port/database
   ```

3. **Install dependencies**
   ```bash
   go mod download
   ```

4. **Run the application**
   ```bash
   go run cmd/api/main.go
   ```

   The server will start on the port specified in `.env` (default: `8080`).

## üì° API Endpoints

### Health Check
| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/health` | Check if API is running |

### Products
| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/api/products` | Get all products |
| GET | `/api/products/{id}` | Get product by ID |
| POST | `/api/products` | Create a new product |
| PUT | `/api/products/{id}` | Update a product |
| DELETE | `/api/products/{id}` | Delete a product |

### Categories
| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/api/categories` | Get all categories |
| GET | `/api/categories/{id}` | Get category by ID |
| POST | `/api/categories` | Create a new category |
| PUT | `/api/categories/{id}` | Update a category |
| DELETE | `/api/categories/{id}` | Delete a category |

## üß™ Example Requests

### Create a Product
```bash
curl -X POST http://localhost:8080/api/produk \
     -H "Content-Type: application/json" \
     -d '{"nama": "Indomie Goreng", "harga": 4000, "stok": 100}'
```

### Get All Categories
```bash
curl http://localhost:8080/api/categories
```

### Update a Category
```bash
curl -X PUT http://localhost:8080/api/categories/1 \
     -H "Content-Type: application/json" \
     -d '{"name": "Makanan Ringan", "description": "Snack dan cemilan"}'
```

## üîß Technologies Used

- **Go 1.25** - Programming language
- **net/http** - Standard library HTTP server with Go 1.22+ routing
- **pgx/v5** - PostgreSQL driver
- **Viper** - Configuration management

## üìù License

MIT License
